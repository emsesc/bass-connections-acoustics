---
title: "Biodiversity Visualizations"
output: html_document
date: "2024-03-31"
---

Load Data

```{r}
library(dplyr)
library(tidyverse)
library(tidyr)
library(knitr)

ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg)) 
    install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}

# usage
packages <- c("ggplot2", "ggpubr", "rstatix", "dplyr", "ggthemes", "ggformula", "ggpmisc", "GGally", "arm", "ggstatsplot", "readr")
ipak(packages)

select <- dplyr::select

AllVars <- read_csv("./AllVarsPAMSitesandBioRich.csv")
species <- AllVars[, 27:ncol(AllVars)]
species <- species[!grepl("total", names(species), ignore.case = TRUE)]
```

Number of Species at Each Site

```{r}
species_count <- AllVars %>%
  select(Total_Species, total_Owls, Total_mammals, total_WP, site)
```

Total Number of Species

```{r}
# Calculate the sum of selected columns
species_numbers <- as.data.frame(colSums(species))
```

Significant Difference by Division (add box plot)

*Compute ANVOA*

```{r}
res.aov <- AllVars %>% anova_test(Total_Species ~ division, detailed = T)
res.aov

#this is how you do it in base R
summary(aov(Total_Species ~ division, data = AllVars))
```

```{r}
# Load the ggplot2 library
library(ggplot2)

# Assuming your data frame is named AllVars, and the variables are Division and Total_Species
# Replace "YourDataFrame" with the name of your actual data frame

# Create the box plot
ggplot(AllVars, aes(x = division, y = Total_Species)) +
  geom_boxplot(fill = "skyblue", color = "blue") +
  labs(title = "Box Plot of Total Species by Division",
       x = "Division",
       y = "Total Species")
```

Significant Correlation with trail distance (scatter plot)

*Log model*

```{r}
log.glm = glm(Total_Species ~ NEAR_DIST_DFTrails+NEAR_STREAM, family=gaussian(link="log"), data=AllVars)
summary(log.glm)
```

```{r}
# Scatter plot of Total_Species against NEAR_DIST_DFTrails
plot(AllVars$NEAR_DIST_DFTrails, AllVars$Total_Species, 
     xlab = "NEAR_DIST_DFTrails", ylab = "Total_Species", 
     main = "Scatter plot with Fitted Line")

# Add the fitted line
abline(log.glm$coefficients["(Intercept)"], log.glm$coefficients["NEAR_DIST_DFTrails"], 
       col = "red")
```
